<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Propose Day ğŸ’–</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(135deg, #ff5f6d, #ffc371);
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Poppins', sans-serif;
  overflow: hidden;
}

.slider {
  width: 360px;
  height: 620px;
  background: #000;
  border-radius: 28px;
  box-shadow: 0 30px 60px rgba(0,0,0,0.35);
  position: relative;
  overflow: hidden;
}

/* Progress bar */
.progress {
  display: flex;
  gap: 4px;
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  z-index: 5;
}
.progress span {
  flex: 1;
  height: 3px;
  background: rgba(255,255,255,0.3);
}
.progress span::after {
  content: "";
  display: block;
  height: 100%;
  width: 0%;
  background: white;
  transition: width 4s linear;
}
.progress span.active::after {
  width: 100%;
}

/* Slides */
.slide {
  position: absolute;
  inset: 0;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
}
.slide.active {
  opacity: 1;
  pointer-events: auto;
}

/* IG nav buttons */
.nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 6;
  background: rgba(0,0,0,0.45);
  color: white;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 20px;
}
.nav-prev { left: 8px; }
.nav-next { right: 8px; }
.nav-btn.hidden { display: none; }

/* IG frame */
.ig-frame {
  width: 100%;
  height: 100%;
  background: #fff;
  display: flex;
  flex-direction: column;
}
.ig-header {
  display: flex;
  align-items: center;
  padding: 10px;
  font-weight: 600;
  border-bottom: 1px solid #eee;
}
.avatar {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: linear-gradient(45deg, #ff4d6d, #ffc371);
  margin-right: 8px;
}
.ig-image { flex: 1; }
.ig-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.icons { padding: 6px 12px; font-size: 18px; }
.ig-caption { padding: 12px; font-size: 14px; }

/* Text slides */
.text-slide {
  background: #fff;
  height: 100%;
  padding: 30px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  text-align: center;
}
h1 { color: #ff4d6d; }
p { color: #444; font-size: 16px; line-height: 1.5; }

.final-buttons {
  display: flex;
  gap: 14px;
  justify-content: center;
  margin-top: 16px;
}
button {
  padding: 12px 28px;
  border-radius: 28px;
  border: none;
  background: #ff4d6d;
  color: white;
  font-size: 16px;
  cursor: pointer;
}
.no { background: #ddd; color: #555; }

/* Confetti */
.confetti {
  position: fixed;
  top: -10px;
  font-size: 18px;
  animation: fall 3s linear forwards;
}
@keyframes fall {
  to {
    transform: translateY(110vh) rotate(360deg);
    opacity: 0;
  }
}

/* Double tap heart */
.heart {
  position: fixed;
  font-size: 40px;
  animation: heartPop 1s ease forwards;
}
@keyframes heartPop {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 0; }
}
</style>
</head>

<body>

<audio id="song">
  <source src="girlfriend.mp3" type="audio/mpeg">
</audio>

<div class="slider" id="slider">

  <div class="progress" id="progress"></div>

  <button class="nav-btn nav-prev" id="prevBtn" onclick="prev()">â€¹</button>
  <button class="nav-btn nav-next" id="nextBtn" onclick="next()">â€º</button>

  <!-- Slides -->
  <div class="slide active">
    <div class="ig-frame">
      <div class="ig-header">
        <div class="avatar"></div>
        <span id="name1"></span>
      </div>
      <div class="ig-image">
        <img src="her-photo.jpg">
      </div>
      <div class="icons">â¤ï¸ ğŸ’¬ âœˆï¸</div>
      <div class="ig-caption">
        <strong id="name2"></strong> this story starts here ğŸ’–
      </div>
    </div>
  </div>

  <div class="slide">
    <div class="text-slide">
      <h1>Happy Propose Day ğŸ’•</h1>
      <p>This wasnâ€™t random.<br>It was always you.</p>
    </div>
  </div>

  <div class="slide">
    <div class="text-slide">
      <p>Somewhere between laughs,<br>thodi nok-zok,<br>and quiet momentsâ€¦</p>
    </div>
  </div>

  <div class="slide">
    <div class="text-slide">
      <h1>I fell for you ğŸ’–</h1>
      <p>And I donâ€™t want to pretend otherwise.</p>
    </div>
  </div>

  <!-- YES / NO slide (NEXT DISABLED HERE) -->
  <div class="slide">
    <div class="text-slide">
      <h1 id="finalText"></h1>
      <div class="final-buttons">
        <button onclick="yes()">Yes ğŸ’•</button>
        <button class="no" id="noBtn">No</button>
      </div>
    </div>
  </div>

  <!-- Final slide -->
  <div class="slide">
    <div class="text-slide">
      <h1>I Love You ğŸŒğŸ’–</h1>
      <p>
        Je tâ€™aime Â· Ich liebe dich Â· Te amo Â· Ti amo<br>
        æ„›ã—ã¦ã‚‹ Â· ì‚¬ë‘í•´ Â· à¤®à¥ˆà¤‚ à¤¤à¥à¤®à¤¸à¥‡ à¤ªà¥à¤¯à¤¾à¤° à¤•à¤°à¤¤à¤¾ à¤¹à¥‚à¤ Â· æˆ‘çˆ±ä½ 
      </p>
      <button onclick="saveStory()">Save this story ğŸ“¸</button>
    </div>
  </div>

</div>

<script>
const herName = "Ekta"; // CHANGE NAME
document.getElementById("name1").textContent = herName;
document.getElementById("name2").textContent = herName;
document.getElementById("finalText").textContent =
  `${herName}, will you be mine? ğŸ’–`;

const slides = document.querySelectorAll(".slide");
const slider = document.getElementById("slider");
const song = document.getElementById("song");
const progress = document.getElementById("progress");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

const yesNoSlideIndex = 4;

let current = 0;
let auto;

/* Progress bars */
slides.forEach(() => {
  const span = document.createElement("span");
  progress.appendChild(span);
});
const bars = progress.querySelectorAll("span");

/* Show slide */
function showSlide(i) {
  slides[current].classList.remove("active");
  bars[current].classList.remove("active");

  current = Math.max(0, Math.min(i, slides.length - 1));
  slides[current].classList.add("active");
  bars[current].classList.add("active");

  const isLast = current === slides.length - 1;
  const isYesNo = current === yesNoSlideIndex;

  if (isLast) {
    prevBtn.classList.add("hidden");
    nextBtn.classList.add("hidden");
    return;
  }

  if (isYesNo) {
    nextBtn.classList.add("hidden");
    prevBtn.classList.remove("hidden");
    return;
  }

  prevBtn.classList.remove("hidden");
  nextBtn.classList.remove("hidden");
}

function next() { showSlide(current + 1); }
function prev() { showSlide(current - 1); }

/* Auto-play */
function startAuto() {
  clearInterval(auto);
  auto = setInterval(() => {
    if (current < slides.length - 1) next();
  }, 4000);
}
bars[0].classList.add("active");
startAuto();

/* Hold to pause */
slider.addEventListener("mousedown", () => clearInterval(auto));
slider.addEventListener("mouseup", startAuto);
slider.addEventListener("touchstart", () => clearInterval(auto));
slider.addEventListener("touchend", startAuto);

/* Tap to skip */
slider.addEventListener("click", e => {
  const x = e.clientX;
  const w = slider.clientWidth;
  clearInterval(auto);
  if (x > w / 2) next();
  else prev();
  startAuto();
});

/* Swipe */
let startX = 0;
slider.addEventListener("touchstart", e => startX = e.touches[0].clientX);
slider.addEventListener("touchend", e => {
  const endX = e.changedTouches[0].clientX;
  if (startX - endX > 50) next();
  if (endX - startX > 50) prev();
});

/* Double tap heart */
let lastTap = 0;
slider.addEventListener("click", e => {
  const now = Date.now();
  if (now - lastTap < 300) {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = "â¤ï¸";
    heart.style.left = e.clientX + "px";
    heart.style.top = e.clientY + "px";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 1000);
  }
  lastTap = now;
});

/* Confetti */
function confetti() {
  for (let i = 0; i < 40; i++) {
    const c = document.createElement("div");
    c.className = "confetti";
    c.textContent = "ğŸ‰";
    c.style.left = Math.random() * 100 + "vw";
    document.body.appendChild(c);
    setTimeout(() => c.remove(), 3000);
  }
}

/* YES */
function yes() {
  song.play().catch(()=>{});
  confetti();
  setTimeout(() => showSlide(slides.length - 1), 600);
}

/* No escape */
const noBtn = document.getElementById("noBtn");
noBtn.onmouseover = () => {
  noBtn.style.transform =
    `translate(${Math.random()*60-30}px, ${Math.random()*30-15}px)`;
};

/* Save */
function saveStory() {
  html2canvas(slider).then(canvas => {
    const link = document.createElement("a");
    link.download = "propose-day-story.png";
    link.href = canvas.toDataURL();
    link.click();
  });
}
</script>

</body>
</html>
